<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>代码风格统一 | sys-doc</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/sys-doc/assets/css/0.styles.f2c13968.css" as="style"><link rel="preload" href="/sys-doc/assets/js/app.d8e9f619.js" as="script"><link rel="preload" href="/sys-doc/assets/js/2.01d9652a.js" as="script"><link rel="preload" href="/sys-doc/assets/js/15.28671588.js" as="script"><link rel="prefetch" href="/sys-doc/assets/js/10.e12bf532.js"><link rel="prefetch" href="/sys-doc/assets/js/11.eb67204e.js"><link rel="prefetch" href="/sys-doc/assets/js/12.7136e253.js"><link rel="prefetch" href="/sys-doc/assets/js/13.a1feb60a.js"><link rel="prefetch" href="/sys-doc/assets/js/14.b0c7cf4d.js"><link rel="prefetch" href="/sys-doc/assets/js/16.edc12257.js"><link rel="prefetch" href="/sys-doc/assets/js/17.13d64156.js"><link rel="prefetch" href="/sys-doc/assets/js/18.61d35156.js"><link rel="prefetch" href="/sys-doc/assets/js/19.05bd98c3.js"><link rel="prefetch" href="/sys-doc/assets/js/20.a0cf136a.js"><link rel="prefetch" href="/sys-doc/assets/js/21.03ded64d.js"><link rel="prefetch" href="/sys-doc/assets/js/22.48cb9c16.js"><link rel="prefetch" href="/sys-doc/assets/js/23.0c180cf1.js"><link rel="prefetch" href="/sys-doc/assets/js/24.77e09a3e.js"><link rel="prefetch" href="/sys-doc/assets/js/25.e55672d9.js"><link rel="prefetch" href="/sys-doc/assets/js/26.e11de8a1.js"><link rel="prefetch" href="/sys-doc/assets/js/27.e81e4d27.js"><link rel="prefetch" href="/sys-doc/assets/js/28.86516cc2.js"><link rel="prefetch" href="/sys-doc/assets/js/29.feeb398a.js"><link rel="prefetch" href="/sys-doc/assets/js/3.50da570f.js"><link rel="prefetch" href="/sys-doc/assets/js/30.18bddb07.js"><link rel="prefetch" href="/sys-doc/assets/js/31.06c84a2e.js"><link rel="prefetch" href="/sys-doc/assets/js/32.e314141f.js"><link rel="prefetch" href="/sys-doc/assets/js/33.245c25a8.js"><link rel="prefetch" href="/sys-doc/assets/js/34.98ca6147.js"><link rel="prefetch" href="/sys-doc/assets/js/35.416394de.js"><link rel="prefetch" href="/sys-doc/assets/js/36.189ed700.js"><link rel="prefetch" href="/sys-doc/assets/js/37.ea3b68b8.js"><link rel="prefetch" href="/sys-doc/assets/js/38.7779b874.js"><link rel="prefetch" href="/sys-doc/assets/js/39.6d8c0228.js"><link rel="prefetch" href="/sys-doc/assets/js/4.ba3164ba.js"><link rel="prefetch" href="/sys-doc/assets/js/40.833df0a0.js"><link rel="prefetch" href="/sys-doc/assets/js/41.e15859ac.js"><link rel="prefetch" href="/sys-doc/assets/js/42.50d4eaf7.js"><link rel="prefetch" href="/sys-doc/assets/js/43.ab0f24bd.js"><link rel="prefetch" href="/sys-doc/assets/js/44.1abefe21.js"><link rel="prefetch" href="/sys-doc/assets/js/45.a9a90201.js"><link rel="prefetch" href="/sys-doc/assets/js/46.a3cab201.js"><link rel="prefetch" href="/sys-doc/assets/js/47.c2690f0e.js"><link rel="prefetch" href="/sys-doc/assets/js/48.b68b2b19.js"><link rel="prefetch" href="/sys-doc/assets/js/49.cb96763b.js"><link rel="prefetch" href="/sys-doc/assets/js/5.75a3592b.js"><link rel="prefetch" href="/sys-doc/assets/js/50.68a84c7c.js"><link rel="prefetch" href="/sys-doc/assets/js/51.26054d26.js"><link rel="prefetch" href="/sys-doc/assets/js/52.8e98eb4d.js"><link rel="prefetch" href="/sys-doc/assets/js/53.354e7bd3.js"><link rel="prefetch" href="/sys-doc/assets/js/54.0f23ef6f.js"><link rel="prefetch" href="/sys-doc/assets/js/55.071e2888.js"><link rel="prefetch" href="/sys-doc/assets/js/56.6cb20abf.js"><link rel="prefetch" href="/sys-doc/assets/js/57.aa113bfe.js"><link rel="prefetch" href="/sys-doc/assets/js/58.76b85648.js"><link rel="prefetch" href="/sys-doc/assets/js/59.a4afa128.js"><link rel="prefetch" href="/sys-doc/assets/js/6.0377ba0c.js"><link rel="prefetch" href="/sys-doc/assets/js/60.ebe556d0.js"><link rel="prefetch" href="/sys-doc/assets/js/61.2007a023.js"><link rel="prefetch" href="/sys-doc/assets/js/62.41731cca.js"><link rel="prefetch" href="/sys-doc/assets/js/63.82eba2f5.js"><link rel="prefetch" href="/sys-doc/assets/js/64.36ac371c.js"><link rel="prefetch" href="/sys-doc/assets/js/65.52bcf092.js"><link rel="prefetch" href="/sys-doc/assets/js/66.674b4f8d.js"><link rel="prefetch" href="/sys-doc/assets/js/67.a732865b.js"><link rel="prefetch" href="/sys-doc/assets/js/68.872a0efc.js"><link rel="prefetch" href="/sys-doc/assets/js/69.19aa3b32.js"><link rel="prefetch" href="/sys-doc/assets/js/7.dc078c9b.js"><link rel="prefetch" href="/sys-doc/assets/js/70.83ac44b2.js"><link rel="prefetch" href="/sys-doc/assets/js/71.503bbcf1.js"><link rel="prefetch" href="/sys-doc/assets/js/72.a64cf2db.js"><link rel="prefetch" href="/sys-doc/assets/js/73.3dd465e9.js"><link rel="prefetch" href="/sys-doc/assets/js/74.f0c960da.js"><link rel="prefetch" href="/sys-doc/assets/js/75.f1e4a186.js"><link rel="prefetch" href="/sys-doc/assets/js/76.2b2a6934.js"><link rel="prefetch" href="/sys-doc/assets/js/77.40b928a4.js"><link rel="prefetch" href="/sys-doc/assets/js/78.536b88ce.js"><link rel="prefetch" href="/sys-doc/assets/js/79.4b8fb840.js"><link rel="prefetch" href="/sys-doc/assets/js/8.ada5e17a.js"><link rel="prefetch" href="/sys-doc/assets/js/80.b02dec95.js"><link rel="prefetch" href="/sys-doc/assets/js/81.6eb94ef2.js"><link rel="prefetch" href="/sys-doc/assets/js/82.3a8c1521.js"><link rel="prefetch" href="/sys-doc/assets/js/83.1cec6ac3.js"><link rel="prefetch" href="/sys-doc/assets/js/9.fde67e0a.js">
    <link rel="stylesheet" href="/sys-doc/assets/css/0.styles.f2c13968.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/sys-doc/" class="home-link router-link-active"><img src="/sys-doc/imgs/logo.jpeg" alt="sys-doc" class="logo"> <span class="site-name can-hide">sys-doc</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/sys-doc/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/sys-doc/programme/" class="nav-link">
  编程
</a></div><div class="nav-item"><a href="/sys-doc/engineer/" class="nav-link router-link-active">
  工程
</a></div><div class="nav-item"><a href="/sys-doc/framework/" class="nav-link">
  架构
</a></div><div class="nav-item"><a href="/sys-doc/shell/" class="nav-link">
  集锦
</a></div><div class="nav-item"><a href="/sys-doc/leetCode/" class="nav-link">
  LCode
</a></div> <a href="https://github.com/chttyCode/sys-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/sys-doc/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/sys-doc/programme/" class="nav-link">
  编程
</a></div><div class="nav-item"><a href="/sys-doc/engineer/" class="nav-link router-link-active">
  工程
</a></div><div class="nav-item"><a href="/sys-doc/framework/" class="nav-link">
  架构
</a></div><div class="nav-item"><a href="/sys-doc/shell/" class="nav-link">
  集锦
</a></div><div class="nav-item"><a href="/sys-doc/leetCode/" class="nav-link">
  LCode
</a></div> <a href="https://github.com/chttyCode/sys-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/sys-doc/engineer/" aria-current="page" class="sidebar-link">工程</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>组件库开发</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sys-doc/engineer/component.html" aria-current="page" class="active sidebar-link">代码风格统一</a></li><li><a href="/sys-doc/engineer/component-1.html" class="sidebar-link">/engineer/component-1.html</a></li><li><a href="/sys-doc/engineer/component-2.html" class="sidebar-link">组件开发流程</a></li><li><a href="/sys-doc/engineer/component-3.html" class="sidebar-link">组件文档生成</a></li><li><a href="/sys-doc/engineer/component-4.html" class="sidebar-link">组件发布</a></li><li><a href="/sys-doc/engineer/component-5.html" class="sidebar-link">CI/CD</a></li><li><a href="/sys-doc/engineer/component-6.html" class="sidebar-link">脚手架搭建</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="代码风格统一"><a href="#代码风格统一" class="header-anchor">#</a> 代码风格统一</h1> <ul><li><p>webpack babel-loader</p> <ul><li><p>webpack 编译采用的是 ts-load、统一编译&amp;校验</p> <ul><li>babel-loader@8.2.3 调用 babel 进行编辑</li> <li>@babel/core@7.16.5 babel 核心包 只能转语法</li> <li>@babel/preset-env@7.16.5 预设集合</li> <li>@babel/plugin-transform-runtime@7.16.5 用于提取公共 helpers</li> <li>core-js@3.19.3 提供 api 转译</li> <li>@babel/plugin-proposal-decorators@7.16.5 提供装饰器</li> <li>@babel/plugin-proposal-class-properties@7.16.5 编译为宽松类型属性定义</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    npm i babel<span class="token operator">-</span>loader@<span class="token number">8.2</span><span class="token number">.3</span> @babel<span class="token operator">/</span>core@<span class="token number">7.16</span><span class="token number">.5</span>   @babel<span class="token operator">/</span>preset<span class="token operator">-</span>env@<span class="token number">7.16</span><span class="token number">.5</span> @babel<span class="token operator">/</span>plugin<span class="token operator">-</span>transform<span class="token operator">-</span>runtime@<span class="token number">7.16</span><span class="token number">.5</span> core<span class="token operator">-</span>js@<span class="token number">3.19</span><span class="token number">.3</span>  @babel<span class="token operator">/</span>plugin<span class="token operator">-</span>proposal<span class="token operator">-</span>decorators@<span class="token number">7.16</span><span class="token number">.5</span>   @babel<span class="token operator">/</span>plugin<span class="token operator">-</span>proposal<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">-</span>properties@<span class="token number">7.16</span><span class="token number">.5</span>  @babel<span class="token operator">/</span>preset<span class="token operator">-</span>react@<span class="token number">7.16</span><span class="token number">.5</span> @babel<span class="token operator">/</span>preset<span class="token operator">-</span>typescript@<span class="token number">7.16</span><span class="token number">.5</span> <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><ul><li><p>问题</p> <ul><li>@types/react 存在循环引用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>node_modules<span class="token operator">/</span>@types<span class="token operator">/</span>react<span class="token operator">/</span>index<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">ts</span><span class="token punctuation">(</span><span class="token number">239</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">:</span> error <span class="token constant">TS2456</span><span class="token operator">:</span> Type alias <span class="token string">'ReactFragment'</span> circularly references itself<span class="token punctuation">.</span>
 <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>  @types<span class="token operator">/</span>react<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token keyword">interface</span> <span class="token class-name">ReactNodeArray</span> <span class="token keyword">extends</span> <span class="token class-name">ReadonlyArray</span><span class="token operator">&lt;</span>ReactNode<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
type ReactFragment <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">|</span> Iterable<span class="token operator">&lt;</span>ReactNode<span class="token operator">&gt;</span><span class="token punctuation">;</span>
type ReactNode <span class="token operator">=</span> ReactChild <span class="token operator">|</span> ReactFragment <span class="token operator">|</span> ReactPortal <span class="token operator">|</span> boolean <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
</code></pre></div><div class="language- extra-class"><pre><code>- 查看package.json发现其依赖的typescript版本为next即最新，尝试升级typescript解决问题
</code></pre></div><ul><li>第三方库@types/react-slick 依赖包中有依赖 @types/react:'*',导致该依赖 node_modules 下安装了 不同版本的 @types/react</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>node_modules<span class="token operator">/</span>@types<span class="token operator">/</span>react<span class="token operator">-</span>slick<span class="token operator">/</span>node_modules<span class="token operator">/</span>@types<span class="token operator">/</span>react<span class="token operator">/</span>index<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">ts</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">:</span> error <span class="token constant">TS2456</span><span class="token operator">:</span> Type alias <span class="token string">'ReactNode'</span> circularly references itself<span class="token punctuation">.</span>
node_modules<span class="token operator">/</span>@types<span class="token operator">/</span>react<span class="token operator">-</span>slick<span class="token operator">/</span>node_modules<span class="token operator">/</span>@types<span class="token operator">/</span>react<span class="token operator">/</span>index<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">ts</span><span class="token punctuation">(</span><span class="token number">3100</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token operator">:</span> error <span class="token constant">TS2300</span><span class="token operator">:</span> Duplicate identifier <span class="token string">'LibraryManagedAttributes'</span><span class="token punctuation">.</span>
</code></pre></div><div class="language- extra-class"><pre><code>- 将项目的依赖设置为'*'任意版本
&gt; npm3.x之后的版本中node_module采用扁平化方式安装依赖(较嵌套安装,存在代码冗余、访问路劲过长等问题)，不管直接依还是子依赖优先安装在根目录下，安装时如果已存相同版本则跳过，如果已存在不符合版本则安装在当前模块的node_modules下
&gt; npm install 时5.0.x,不管package.json直接根据lock下载,存在的问题[issues 16866](https://github.com/npm/npm/issues/16866)
&gt; 5.1.x版本，package.json有新版本时，会无视lock根据package.json下载最新的并更新lock，存在的问题[issue 17979](https://github.com/npm/npm/issues/17979)
&gt; 5.4.2版本之后，如果只有package.json则根据package.json安装并生成lock文件，
&gt; 5.4.2版本之后，如果package&amp;lock同时存在,package有新版本，但是lock版本在package.json指定的版本范围内，会安装lock的版本
&gt; 5.4.2版本之后，如果package&amp;lock同时存在,package有新版本，但是lock版本不在package.json指定的版本范围内，会根据package版本，更新lock文件
</code></pre></div></li></ul></li> <li><p>.babelrc 配置</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 适用于业务代码配置 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">[</span>
            <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">&quot;@babel/preset-react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;@babel/preset-typescript&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">[</span>
            <span class="token string">&quot;@babel/plugin-transform-runtime&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                <span class="token string">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-decorators&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">&quot;legacy&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-proposal-class-properties&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">&quot;legacy&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token string">&quot;import&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">&quot;libraryName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;antd&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;libraryDirectory&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lib&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;antd&quot;</span><span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

</code></pre></div></li> <li><p>prettier</p> <div class="language-js extra-class"><pre class="language-js"><code>    npm i prettier <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div></li> <li><p>eslint</p> <ul><li><p>自带解释器支持支 ECMAScript 语法</p> <ul><li>plugin 推荐
<ul><li>eslint-plugin-react react 规则</li> <li>eslint-plugin-babel 允许 ESLint 在由 Babel 转换的源代码上运行</li> <li>eslint-plugin-import 支持 ECMAScript 2015(ES6) 和更高版本的导入/导出的路径&amp;导出名称校验</li> <li>eslint-plugin-jsx-a11y 用于 JSX 元素可访问性规则的静态 AST 检查器</li> <li>eslint-plugin-react-hooks 强制执行 Hooks 规则</li> <li>@typescript-eslint/eslint-plugin</li></ul></li></ul></li> <li><p>问题</p> <ul><li>添加 rules 校验时需增加指定 parserOptions 配置</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    Error<span class="token operator">:</span> Error <span class="token keyword">while</span> loading rule <span class="token string">'@typescript-eslint/await-thenable'</span><span class="token operator">:</span> You have used a rule which requires parserServices to be generated<span class="token punctuation">.</span> You must therefore provide a value <span class="token keyword">for</span> the <span class="token string">&quot;parserOptions.project&quot;</span> property <span class="token keyword">for</span> @typescript<span class="token operator">-</span>eslint<span class="token operator">/</span>parser<span class="token punctuation">.</span>
</code></pre></div><ul><li>typescript 3.7 版本问题，upgrade &gt;3.9 即可</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> checker<span class="token punctuation">.</span>getTypeArguments is not a <span class="token keyword">function</span>
</code></pre></div><ul><li>v4.2 has some breaking changes - 无法捕获 yield 表达式的类型，会抛出错误</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token constant">D</span><span class="token operator">:</span><span class="token operator">/</span>work<span class="token operator">/</span>iair<span class="token operator">-</span>web<span class="token operator">/</span>app<span class="token operator">/</span>api<span class="token operator">/</span>applyChangeIairOrderFront<span class="token punctuation">.</span>ts
    TypeScript error <span class="token keyword">in</span> <span class="token constant">D</span><span class="token operator">:</span><span class="token operator">/</span>work<span class="token operator">/</span>iair<span class="token operator">-</span>web<span class="token operator">/</span>app<span class="token operator">/</span>api<span class="token operator">/</span>applyChangeIairOrderFront<span class="token punctuation">.</span><span class="token function">ts</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token string">'yield'</span> expression implicitly results <span class="token keyword">in</span> an <span class="token string">'any'</span> type because its containing generator lacks a <span class="token keyword">return</span><span class="token operator">-</span>type annotation<span class="token punctuation">.</span>  <span class="token constant">TS7057</span>

        <span class="token number">7</span> <span class="token operator">|</span>   <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token number">8</span> <span class="token operator">|</span>   <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token operator">&gt;</span>  <span class="token number">9</span> <span class="token operator">|</span>     res <span class="token operator">=</span> <span class="token keyword">yield</span> axios<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'air-app'</span><span class="token punctuation">,</span> <span class="token string">'air/change/submit_demand'</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token operator">|</span>           <span class="token operator">^</span>
        <span class="token number">10</span> <span class="token operator">|</span>       version<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token number">11</span> <span class="token operator">|</span>       apiType<span class="token operator">:</span> <span class="token string">'service'</span><span class="token punctuation">,</span>
        <span class="token number">12</span> <span class="token operator">|</span>     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language- extra-class"><pre><code>- 解决方案
    - 安装 &lt; 4.2版本
    - 添加type
        - [eg](https://vhudyma-blog.eu/yield-expression-implicitly-results-in-an-any-type-because-its-containing-generator-lacks-a-return-type-annotation/)
</code></pre></div></li></ul></li> <li><p>husky</p> <ul><li>&quot;prepare&quot;: &quot;husky install&quot; 在 npm i 时会自动执行该命令，初始化 husky
<ul><li>利用 git 可以通过 core.hooks 指定 hooks 文件的能力，在文件中显示的注册构造</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    npm set<span class="token operator">-</span>script prepare <span class="token string">&quot;husky install&quot;</span>
</code></pre></div></li> <li>添加指定的 hooks<div class="language-js extra-class"><pre class="language-js"><code>    npx husky add <span class="token punctuation">.</span>husky<span class="token operator">/</span>pre<span class="token operator">-</span>commit <span class="token string">&quot;npm test&quot;</span>
</code></pre></div></li> <li>pre-commit 钩子
<ul><li>执行 lint-staged ，对暂存区内容进行校验</li></ul></li> <li>commit-msg 钩子
<ul><li>对提交 message 的格式进行校验</li> <li>统一团队提交规范</li> <li>对错误 msg 格式给出提示</li></ul></li> <li>注意点
<ul><li>npm set-script 命令在 v 7.x 之后支持
<ul><li>升级 npm 到 v7.x</li></ul></li> <li>通过 husky add 添加的脚本会存在编码问题<div class="language-js extra-class"><pre class="language-js"><code>SyntaxError<span class="token operator">:</span> Invalid or unexpected token
</code></pre></div><ul><li>手动调整 pre-commit 脚本的编码格式</li> <li>手动创建 pre-commit 文件</li></ul></li> <li>需添加 prepare script 命令，注册 husky 的 hooks</li> <li>vs old config package.json 无需添加校验规则</li></ul></li></ul></li> <li><p>lint-staged</p> <ul><li><p>增量校验、避免全量校验</p></li> <li><p>使用方式</p> <ul><li>命令行方式</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>  npx mrm@<span class="token number">2</span> lint<span class="token operator">-</span>staged
</code></pre></div><ul><li><p>手动配置</p> <ul><li>支持多种定义方式
<ul><li>package.json</li> <li>.lintstagedrc</li></ul></li></ul></li> <li><p>lint 解析流程</p> <ul><li>自动解析 git root，无需配置</li> <li>选择存在于项目目录中的暂存文件</li> <li>使用指定的 glob 模式过滤它们</li> <li>将绝对路径作为参数传递给 linter</li></ul></li> <li><p>with husky</p> <ul><li>在 husky 的 pre-commit hooks 执行 npx --no-install lint-staged</li> <li>配置 lint-staged<div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 方式<span class="token number">1</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token string">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;app/**/*.{ts,tsx}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;eslint --quiet&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;prettier --write&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;app/**/*.scss&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;stylelint --syntax scss&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;stylelint --syntax scss --fix&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div>vs<div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 方式<span class="token number">2</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token string">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;app/**/*.{ts,tsx}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;npm run lint:ts&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;prettier --write&quot;</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;app/**/*.scss&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;stylelint --syntax scss&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;stylelint --syntax scss --fix&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div></li></ul></li> <li><p>注意点</p> <ul><li>方式 1：lint-staged 可以对过滤的文件执行 eslint 命令</li> <li>方式 2：不能 get 到暂存区的文件，是全量的 lint</li> <li>v10 版本之后不再需要手动 git add 将修复的内容添加到暂存区，会自动执行</li></ul></li> <li><p>存在问题</p> <div class="language-js extra-class"><pre class="language-js"><code>    $ git commit <span class="token operator">-</span>m <span class="token string">'chore: styelint'</span>
    <span class="token punctuation">(</span>node<span class="token operator">:</span><span class="token number">34188</span><span class="token punctuation">)</span> ExperimentalWarning<span class="token operator">:</span> The <span class="token constant">ESM</span> module loader is experimental<span class="token punctuation">.</span>
    internal<span class="token operator">/</span>modules<span class="token operator">/</span>run_main<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">54</span>
        <span class="token function">internalBinding</span><span class="token punctuation">(</span><span class="token string">'errors'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">triggerUncaughtException</span><span class="token punctuation">(</span>
                                <span class="token operator">^</span>

    Error <span class="token punctuation">[</span><span class="token constant">ERR_UNSUPPORTED_ESM_URL_SCHEME</span><span class="token punctuation">]</span><span class="token operator">:</span> Only file and data URLs are supported by the <span class="token keyword">default</span> <span class="token constant">ESM</span> loader
        at Loader<span class="token punctuation">.</span>defaultResolve <span class="token punctuation">[</span><span class="token keyword">as</span> _resolve<span class="token punctuation">]</span> <span class="token punctuation">(</span>internal<span class="token operator">/</span>modules<span class="token operator">/</span>esm<span class="token operator">/</span>resolve<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">727</span><span class="token operator">:</span><span class="token number">11</span><span class="token punctuation">)</span>
        at Loader<span class="token punctuation">.</span><span class="token function">resolve</span> <span class="token punctuation">(</span>internal<span class="token operator">/</span>modules<span class="token operator">/</span>esm<span class="token operator">/</span>loader<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">97</span><span class="token operator">:</span><span class="token number">40</span><span class="token punctuation">)</span>
        at Loader<span class="token punctuation">.</span><span class="token function">getModuleJob</span> <span class="token punctuation">(</span>internal<span class="token operator">/</span>modules<span class="token operator">/</span>esm<span class="token operator">/</span>loader<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">243</span><span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">)</span>
        at ModuleWrap<span class="token punctuation">.</span><span class="token operator">&lt;</span>anonymous<span class="token operator">&gt;</span> <span class="token punctuation">(</span>internal<span class="token operator">/</span>modules<span class="token operator">/</span>esm<span class="token operator">/</span>module_job<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">40</span><span class="token punctuation">)</span>
        at <span class="token function">link</span> <span class="token punctuation">(</span><span class="token parameter">internal<span class="token operator">/</span>modules<span class="token operator">/</span>esm<span class="token operator">/</span>module_job<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">45</span><span class="token operator">:</span><span class="token number">36</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    code<span class="token operator">:</span> <span class="token string">'ERR_UNSUPPORTED_ESM_URL_SCHEME'</span>
    <span class="token punctuation">}</span>
    husky <span class="token operator">-</span> pre<span class="token operator">-</span>commit hook exited <span class="token keyword">with</span> code <span class="token number">1</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span>
</code></pre></div><ul><li>排查
<ul><li>node 版本 v14.3.0 还是存在问题</li> <li>排查 husky，当前版本没问题</li> <li>排查 lint-staged&gt; v12.0.0 时,对当前的 node 环境有要求
<ul><li>由于项目 node 版本是 12,所以选择降低 lint-staged 版到 11</li></ul></li></ul></li></ul></li></ul></li></ul></li> <li><p>commit msg</p> <ul><li><p>@commitlint/cli：检测提交消息</p></li> <li><p>msg 格式校验方案</p> <ul><li>commitlint-config-gitmoji：需要手动添加 JSON 数据</li> <li>@commitlint/config-angular：为 angular 的提交模板</li> <li>@commitlint/config-conventional 官方推荐</li></ul></li> <li><p>校验失败给出 msg 消息模板</p> <ul><li>husky 的 commit-msg 钩子进行配置修改
<ul><li>shell 脚本执行失败没有退出会继续执行后续 shell</li> <li>以非 0 代码结束，打断提交</li></ul></li> <li>添加失败提示模板</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> #<span class="token operator">!</span><span class="token operator">/</span>bin<span class="token operator">/</span>sh
<span class="token punctuation">.</span> <span class="token string">&quot;$(dirname &quot;</span>$<span class="token number">0</span><span class="token string">&quot;)/_/husky.sh&quot;</span>

<span class="token keyword">if</span> <span class="token operator">!</span> npx <span class="token operator">--</span>no<span class="token operator">-</span>install commitlint <span class="token operator">--</span>edit $<span class="token number">1</span> <span class="token punctuation">;</span> then
echo <span class="token operator">-</span>e &quot;
\<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">31</span>m commit 格式错误，正确示例<span class="token operator">:</span> git commit <span class="token operator">-</span>m <span class="token string">'fix: 修复bug'</span> \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">0</span>m
    \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">33</span>m  <span class="token function">type</span><span class="token punctuation">(</span>类型如下<span class="token punctuation">)</span> \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">0</span>m\r
    \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">33</span>m  feat<span class="token operator">:</span>新功能 \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">0</span>m\r
    \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">33</span>m  fix<span class="token operator">:</span>修复bug \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">0</span>m\r
    \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">33</span>m  refactor<span class="token operator">:</span>重构 \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">0</span>m\r
    \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">33</span>m  style<span class="token operator">:</span>格式 \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">0</span>m\r
    \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">33</span>m  chore<span class="token operator">:</span>构建过程或辅助工具变动 \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">0</span>m\r
    \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">33</span>m  docs<span class="token operator">:</span>文档 \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">0</span>m\r
    \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">33</span>m  test<span class="token operator">:</span>测试 \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">0</span>m\r
    \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">33</span>m  revert<span class="token operator">:</span>回滚 \<span class="token number">033</span><span class="token punctuation">[</span><span class="token number">0</span>m\r
    &quot;<span class="token punctuation">;</span> exit <span class="token number">1</span><span class="token punctuation">;</span>
fi
</code></pre></div></li></ul></li> <li><p>eslint conflicts prettier</p> <ul><li>避免这个问题的一个好方法是使用 Prettier 作为 ESLint 插件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>prettier@<span class="token number">4.0</span><span class="token number">.0</span>
</code></pre></div><ul><li>用 prettier 规则</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>    npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev eslint<span class="token operator">-</span>config<span class="token operator">-</span>prettier@<span class="token number">8.3</span><span class="token number">.0</span>
</code></pre></div><div class="language- extra-class"><pre><code>- prettier置于plugin最后，用于覆盖与eslint冲突的规则
</code></pre></div><ul><li>依然有一个问题 indent
<ul><li>eslint &amp; prettier 有相互独立的缩进规则，疑问?eslint-config-prettier 竟然不能屏蔽 eslint 的 indent 规则</li> <li><a href="https://github.com/eslint/eslint/issues/10930" target="_blank" rel="noopener noreferrer">Kai Cataldo's comment <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></li> <li><p>.eslintrc.js</p> <ul><li>本规则，基于最新的华为前端开发规范，具体可见链接
<ul><li><a href="http://w3.huawei.com/ipd/tsl/#!tsl_new/standard/standard.html?standardId=43549" target="_blank" rel="noopener noreferrer">华为 JavaScript 语言通用编程规范<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>rules
<a href="https://git.huawei.com/h00508685/eslint-demo/blob/master/.eslintrc.js" target="_blank" rel="noopener noreferrer">eslint rules 规则<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 本规则，基于最新的华为前端开发规范，具体可见链接：
 * http://w3.huawei.com/ipd/tsl/#!tsl_new/standard/standard.html?standardId=43549
 */</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    parser<span class="token operator">:</span> <span class="token string">'@typescript-eslint/parser'</span><span class="token punctuation">,</span> <span class="token comment">// 5.8.0</span>
    parserOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
        ecmaVersion<span class="token operator">:</span> <span class="token number">2015</span><span class="token punctuation">,</span>
        <span class="token comment">// ECMAScript modules 模式</span>
        sourceType<span class="token operator">:</span> <span class="token string">'module'</span><span class="token punctuation">,</span>
        ecmaFeatures<span class="token operator">:</span> <span class="token punctuation">{</span>
            jsx<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    env<span class="token operator">:</span> <span class="token punctuation">{</span>
        browser<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        node<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        commonjs<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        es6<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    settings<span class="token operator">:</span> <span class="token punctuation">{</span>
        react<span class="token operator">:</span> <span class="token punctuation">{</span>
            version<span class="token operator">:</span> <span class="token string">'detect'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">'import/extensions'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.ts'</span><span class="token punctuation">,</span> <span class="token string">'.tsx'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">,</span> <span class="token string">'jsx-a11y'</span><span class="token punctuation">,</span> <span class="token string">'@typescript-eslint'</span><span class="token punctuation">,</span> <span class="token string">'react-hooks'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'eslint:recommended'</span><span class="token punctuation">,</span>
        <span class="token string">'plugin:@typescript-eslint/recommended'</span><span class="token punctuation">,</span>
        <span class="token string">'plugin:@typescript-eslint/recommended-requiring-type-checking'</span><span class="token punctuation">,</span>
        <span class="token string">'plugin:react-hooks/recommended'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    rules<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token comment">//------------------------前端规范-排版格式-------------------------------</span>
        <span class="token comment">/**
         * 前端规范规则16	超长代码需要被换行
         * 规则22	每行代码应该少于120个字符（以此为准）
         */</span>

        <span class="token comment">/**
         * 建议5	方法的参数尽量在一行显示
         */</span>
        <span class="token string">'function-paren-newline'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token string">'multiline'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议6	对象字面量属性超过4个, 需要都换行
         */</span>
        <span class="token string">'object-property-newline'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> allowAllPropertiesOnSameLine<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议7	链式调用对象方法时，一行最多调用4次，否则需要换行
         */</span>
        <span class="token string">'newline-per-chained-call'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> ignoreChainWithDepth<span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则20	给if、for、do、while等语句的执行体加花括号 {}
         */</span>
        curly<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议15	使用拖尾逗号
         */</span>
        <span class="token string">'comma-dangle'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token string">'always-multiline'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议16	每句代码后加分号
         */</span>
        <span class="token string">'semi-style'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token string">'last'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议19	控制文件的长度，最好不要超过2000行
         */</span>
        <span class="token string">'max-lines'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 原则6	方法设计应遵循单一职责原则（SRP），一个方法仅完成一个功能
         */</span>
        <span class="token string">'max-lines-per-function'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议21	圈复杂度不超过20
         * 软件学院统一要求是：10
         */</span>
        complexity<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议22	块语句的最大可嵌套深度不要超过4层
         */</span>
        <span class="token string">'max-depth'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议23	回调函数嵌套的层数不超过4层
         */</span>
        <span class="token string">'max-nested-callbacks'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则25	禁止连续赋值
         */</span>
        <span class="token string">'no-multi-assign'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则26	变量不需要用undefined初始化
         */</span>
        <span class="token string">'no-undef-init'</span><span class="token operator">:</span> <span class="token string">'warn'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则67	块内变量不能与函数内的其他变量同名，块内函数应该使用函数表达式声明
         */</span>
        <span class="token string">'no-shadow'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议26	方法的参数个数不宜超过5个
         */</span>
        <span class="token string">'max-params'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则28	不要把方法的入参当作工作变量/临时变量
         */</span>
        <span class="token string">'no-param-reassign'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则29	不要使用 arguments，可以选择 rest 语法替代
         */</span>
        <span class="token string">'prefer-rest-params'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议31	function 声明或表达式的一致性
         */</span>
        <span class="token string">'func-style'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token string">'declaration'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> allowArrowFunctions<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则30	用到匿名函数时优先使用箭头函数（或 Function#bind），别保存 this 的引用
         */</span>
        <span class="token string">'prefer-arrow-callback'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则31	箭头函数的简写
         */</span>
        <span class="token string">'arrow-body-style'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token string">'as-needed'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则32	要求使用一致的 return 语句
         */</span>
        <span class="token string">'consistent-return'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则35	在构造函数中禁止在调用super()之前使用this或super
         */</span>
        <span class="token string">'no-this-before-super'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议36	建议字符串使用单引号
         */</span>
        quotes<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'warn'</span><span class="token punctuation">,</span> <span class="token string">'single'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则36	使用模板字符串（`）实现字符串拼接
         */</span>
        <span class="token string">'prefer-template'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议37	不要使用字符串的行连续符号
         */</span>
        <span class="token string">'no-multi-str'</span><span class="token operator">:</span> <span class="token string">'warn'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议43	推荐在对象字面量中使用属性简写
         */</span>
        <span class="token string">'object-shorthand'</span><span class="token operator">:</span> <span class="token string">'warn'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则41	使用点号来访问对象的属性，只有属性是动态的时候使用 []
         */</span>
        <span class="token string">'dot-notation'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则42	getter和setter应该成对出现在对象中
         */</span>
        <span class="token string">'accessor-pairs'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则43	禁止在对象实例上直接使用 Object.prototypes 的内置属性
         */</span>
        <span class="token string">'no-prototype-builtins'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则44	需要约束 for-in
         */</span>
        <span class="token string">'guard-for-in'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议47	判断相等时使用 === 和 !== ，而不是 == 和 !=
         */</span>
        eqeqeq<span class="token operator">:</span> <span class="token string">'warn'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 建议50	不要使用否定表达式
         */</span>
        <span class="token string">'no-negated-condition'</span><span class="token operator">:</span> <span class="token string">'warn'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则47	每个switch语句都包含一个default语句，即使它不包含任何代码
         */</span>
        <span class="token string">'default-case'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则48	在switch语句的每一个有内容的case中都放置一条break语句
         */</span>
        <span class="token string">'no-fallthrough'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则49	case语句中需要声明词法时, 花括号{}不能省略
         */</span>
        <span class="token string">'no-case-declarations'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则59	禁止在 finally 语句块中出现控制流语句句块中出现控制流语句
         */</span>
        <span class="token string">'no-unsafe-finally'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 原则8	禁止使用eval()
         */</span>
        <span class="token string">'no-eval'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则61	禁止使用with() {}
         */</span>
        <span class="token string">'no-with'</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>

        <span class="token comment">/**
         * 规则65	禁止使用较短的符号实现类型转换
         */</span>
        <span class="token string">'no-implicit-coercion'</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'error'</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                allow<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'!!'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'prettier/prettier'</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">'error'</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
                endOfLine<span class="token operator">:</span> <span class="token string">'auto'</span><span class="token punctuation">,</span>
                printWidth<span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>
                tabWidth<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    overrides<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            files<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'*.ts'</span><span class="token punctuation">,</span> <span class="token string">'*.tsx'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// Your TypeScript files extension</span>
            parserOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
                project<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./tsconfig.json'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// Specify it only for TypeScript files</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>第三方库(可信库)</p> <div class="language-JS extra-class"><pre class="language-js"><code>npm i husky@<span class="token number">7.0</span><span class="token number">.4</span> lint<span class="token operator">-</span>staged@<span class="token number">11.2</span><span class="token number">.6</span> @commitlint<span class="token operator">/</span>cli@<span class="token number">13.2</span><span class="token number">.1</span> @commitlint<span class="token operator">/</span>config<span class="token operator">-</span>conventional@<span class="token number">13.2</span><span class="token number">.0</span>  <span class="token operator">-</span><span class="token constant">D</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code> typescript@<span class="token number">4.1</span><span class="token number">.3</span>
 @typescript<span class="token operator">-</span>eslint<span class="token operator">/</span>parser@<span class="token number">5.8</span><span class="token number">.0</span>
 eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>prettier@<span class="token number">4.0</span><span class="token number">.0</span>
 eslint<span class="token operator">-</span>config<span class="token operator">-</span>prettier@<span class="token number">8.3</span><span class="token number">.0</span>
 eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>react@<span class="token number">7.27</span><span class="token number">.1</span>
 eslint<span class="token operator">-</span>plugin<span class="token operator">-</span><span class="token keyword">import</span>@<span class="token number">2.25</span><span class="token number">.3</span>
 eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>react<span class="token operator">-</span>hooks@<span class="token number">4.3</span><span class="token number">.0</span>
 eslint<span class="token operator">-</span>plugin<span class="token operator">-</span>jsx<span class="token operator">-</span>a11y@<span class="token number">6.5</span><span class="token number">.1</span>
 eslint@<span class="token number">7.32</span><span class="token number">.0</span>
 prettier@<span class="token number">2.4</span><span class="token number">.1</span>
 @typescript<span class="token operator">-</span>eslint<span class="token operator">/</span>eslint<span class="token operator">-</span>plugin@<span class="token number">5.8</span><span class="token number">.0</span>

 @commitlint<span class="token operator">/</span>config<span class="token operator">-</span>conventional@<span class="token number">13.2</span><span class="token number">.0</span>
 @commitlint<span class="token operator">/</span>cli@<span class="token number">13.2</span><span class="token number">.1</span>
 lint<span class="token operator">-</span>staged@<span class="token number">11.2</span><span class="token number">.6</span>
 husky@<span class="token number">7.0</span><span class="token number">.4</span>
</code></pre></div></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/chttyCode/sys-doc/edit/master/docs/engineer/component.md" target="_blank" rel="noopener noreferrer">编辑此内容</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/02/25</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/sys-doc/engineer/webpack-source.html" class="prev">
        webpack 解读
      </a></span> <span class="next"><a href="/sys-doc/engineer/component-1.html">
        /engineer/component-1.html
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/sys-doc/assets/js/app.d8e9f619.js" defer></script><script src="/sys-doc/assets/js/2.01d9652a.js" defer></script><script src="/sys-doc/assets/js/15.28671588.js" defer></script>
  </body>
</html>
