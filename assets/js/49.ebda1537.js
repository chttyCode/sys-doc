(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{407:function(t,v,a){"use strict";a.r(v);var _=a(44),s=Object(_.a)({},(function(){var t=this,v=t.$createElement,a=t._self._c||v;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"网络"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络"}},[t._v("#")]),t._v(" 网络")]),t._v(" "),a("h2",{attrs:{id:"http-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-1"}},[t._v("#")]),t._v(" http/1")]),t._v(" "),a("p",[t._v("说到浏览器中的网络，最重要的莫过于 http 了,而要学习 http 做好的方式是探究其演进的过程")]),t._v(" "),a("h3",{attrs:{id:"http-0-9"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-0-9"}},[t._v("#")]),t._v(" http/0.9")]),t._v(" "),a("p",[t._v("http 协议又称超文本传输协议，0.9 也正式用来传输纯文本信息")]),t._v(" "),a("p",[t._v("因为只要解决文本信息的传输，所以客户端和服务器的需求都很明确，只要告诉对方需要文本信息的 name 即可")]),t._v(" "),a("p",[t._v("过程很简单：")]),t._v(" "),a("ol",[a("li",[t._v("建立 tcp 链接")]),t._v(" "),a("li",[t._v("发送 get 请求资源")]),t._v(" "),a("li",[t._v("文档传输完成、断开链接")])]),t._v(" "),a("p",[t._v("此刻的 http:")]),t._v(" "),a("ol",[a("li",[t._v("只有一个请求行")]),t._v(" "),a("li",[t._v("服务器只需返回文本信息")]),t._v(" "),a("li",[t._v("返回内容以 ASCII 字符流来传输的")])]),t._v(" "),a("h3",{attrs:{id:"http-1-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-1-0"}},[t._v("#")]),t._v(" http/1.0")]),t._v(" "),a("p",[t._v("由于浏览器的推出，传输内容变得复杂，传输内容、编码也不再是到单一 ASCII 所能解决的，那浏览器与服务器就不再是你要我给，而是要进行一番协商了")]),t._v(" "),a("p",[t._v("协商的方式就是新增请求头、响应头，以 key-value 形式保存内容")]),t._v(" "),a("p",[t._v("请求头、响应头解决了那些问题")]),t._v(" "),a("ol",[a("li",[t._v("返回文件类型、编码方式，浏览器需要通过类型提供处理方案")]),t._v(" "),a("li",[t._v("文件内容压缩方式，毕竟传输内容不再局限于文本信息")]),t._v(" "),a("li",[t._v("新增状态码，告知浏览器该请求是否可以被解析")]),t._v(" "),a("li",[t._v("提供 cache 机制，告诉浏览器是否要重新发起请求")]),t._v(" "),a("li",[t._v("提供用户代理字段，便于服务器统计")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("accept"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("html\naccept"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("encoding"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" gzip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" deflate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" br\naccept"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Charset"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ISO")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8859")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("utf"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("\naccept"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("language"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" zh"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zh\n")])])]),a("p",[t._v("告诉发展下 1.0 存在的问题")]),t._v(" "),a("ol",[a("li",[t._v("每个请求都要建立 tcp 链接，费时费流量")])]),t._v(" "),a("h3",{attrs:{id:"http1-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http1-1"}},[t._v("#")]),t._v(" http1.1")]),t._v(" "),a("p",[t._v("主要是解决 1.0 发展遇到的问题")]),t._v(" "),a("ol",[a("li",[t._v("提供持久链接，提供请求头告知浏览器 Connection：keep-alive")]),t._v(" "),a("li",[t._v("提供 host 应对虚拟主机问题，即多个域名对应一个 ip")]),t._v(" "),a("li",[t._v("浏览器为每个域名最多同时维护 6 个 TCP 持久连接")]),t._v(" "),a("li",[t._v("使用 CDN 的实现域名分片机制")])]),t._v(" "),a("h2",{attrs:{id:"http-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-2"}},[t._v("#")]),t._v(" http/2")]),t._v(" "),a("p",[t._v("主要解决 1.1 高速发展带来的问题：")]),t._v(" "),a("ol",[a("li",[t._v("支持持久化带来的的对头阻塞")]),t._v(" "),a("li",[t._v("带宽利用率低，带宽是指每秒最大能发送或者接收的字节数。我们把每秒能发送的最大字节数称为上行带宽，每秒能够接收的最大字节数称为下行带宽")])]),t._v(" "),a("p",[t._v("分析：")]),t._v(" "),a("p",[t._v("HTTP/1.1 对带宽的利用率不理想，是因为 HTTP/1.1 很难将带宽用满。比如我们常说的 100M 带宽，实际的下载速度能达到 12.5M/S，而采用 HTTP/1.1 时，也许在加载页面资源时最大只能使用到 2.5M/S，很难将 12.5M 全部用满")]),t._v(" "),a("ol",[a("li",[t._v("tcp 的慢启动，刚开始 TCP 协议会采用一个非常慢的速度去发送数据，然后慢慢加快发送数据的速度，直到发送数据的速度达到一个理想状态，我们把这个过程称为慢启动。慢启动是 TCP 为了减少网络拥塞的一种策略，我们是没有办法改变的。")]),t._v(" "),a("li",[t._v("对同一个域名可同时建立 6 个 tcp 链接，多条链接的会竞争一定的带宽")]),t._v(" "),a("li",[t._v("队头阻塞，tcp 的持久化，虽然可以减少建立 tcp 的连接数和时间，但是持久化是串行")])]),t._v(" "),a("p",[t._v("即慢启动和 TCP 连接之间相互竞争带宽是由于 TCP 本身的机制导致的，而队头阻塞是由于 HTTP/1.1 的机制导致的。由于 tcp 更新涉及硬件，所以暂时没能力去更换 tcp")]),t._v(" "),a("p",[t._v("解决方案：")]),t._v(" "),a("ol",[a("li",[t._v("一个域名只建立一个长链接，解决多链接竞速带宽问题")]),t._v(" "),a("li",[t._v("在一个链接中采用并行请求的方式，多路复用，解决对头阻塞问题")])]),t._v(" "),a("p",[t._v("多路复用：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/sys-doc/imgs/http2.0.png",alt:"alt http2.0"}})]),t._v(" "),a("p",[t._v("http2.0 新增了一个分桢层，主要就是对通信数据添加 ID 编号，这样在多路复用的情况下就可以采用 ID 编号进行消息的合并")]),t._v(" "),a("p",[t._v("在多路复用的基础之上")]),t._v(" "),a("ol",[a("li",[t._v("可以对资源设置优先级")]),t._v(" "),a("li",[t._v("服务器推送，预判推送与请求相关的资源")]),t._v(" "),a("li",[t._v("提供了头部的压缩，即可以对请求响应头进行压缩")])]),t._v(" "),a("h2",{attrs:{id:"http3-0"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http3-0"}},[t._v("#")]),t._v(" http3.0")]),t._v(" "),a("p",[t._v("主要解决 http2.0 的遗留问题")]),t._v(" "),a("ol",[a("li",[t._v("tcp 队头阻塞，主要原因是 http1.0/http2.0 都是基于 tcp 做的，而 tcp 又是为单链接而设计的，并提供了重传机制，即有一个包丢失，就会阻塞其他请求")]),t._v(" "),a("li",[t._v("链接延时，因为 tcp 有三次握手的机制，要消耗 1.5RTT，再加上协商建立 TLS 需要 1 ～ 2RTT，即建立链接就需要 3 ～ 4 个 RTT，如果 1 个 RTT 就可能需要 100 毫秒以上了，这种情况下整个握手过程需要 300 ～ 400 毫秒")]),t._v(" "),a("li",[t._v("tcp 协议僵化,即中间网络互联设备的僵化，操作系统也是导致 TCP 协议僵化的另外一个原因。因为 TCP 协议都是通过操作系统内核来实现的")])]),t._v(" "),a("p",[t._v("解决方案：")]),t._v(" "),a("p",[t._v("此刻可以发现已经探究到了底层的 tcp 协议了，而且不易改变。因此 http3.0 另辟蹊径，基于 UDP 实现了类似于 TCP 的多路数据流、传输可靠性等功能,又称 QUIC 协议。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/sys-doc/imgs/http3.0.png",alt:"alt http3.0"}})]),t._v(" "),a("p",[t._v("QUIC 功能")]),t._v(" "),a("ol",[a("li",[t._v("实现 tcp 的重传机制")]),t._v(" "),a("li",[t._v("建立 TLS 链接")]),t._v(" "),a("li",[t._v("基于 udp 可以传输多个独立数据流的特性实现了 HTTP/2 中的多路复用功能。解决了 TCP 中队头阻塞的问题。")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/sys-doc/imgs/quic.png",alt:"alt http3.0"}})])])}),[],!1,null,null,null);v.default=s.exports}}]);