# 安全

浏览器安全可以分为三大块——Web 页面安全、浏览器网络安全和浏览器系统安全

## 页面安全

Web 世界会是开放的，但我们需要隐私保护

### 同源策略（Same-origin policy）

如果两个 URL 的协议、域名和端口都相同，我们就称这两个 URL 同源

同源策略主要表现在 DOM、Web 数据和网络这三个层面。

#### DOM

同源策略限制了来自不同源的 JavaScript 脚本对当前 DOM 对象读和写的操作。

#### 数据层

同源策略限制了不同源的站点读取当前站点的 Cookie、IndexDB、LocalStorage 等数据

#### 网络

同源策略限制了通过 XMLHttpRequest 等方式将站点的数据发送给不同源的站点

### 安全和便利性的权衡

隔绝是安全的，但是开发又是必须的，业务中肯定会有跨站点访问的场景，浏览器安全策略中提供的平衡技术

#### 第一步资源放开

同源策略要求页面所有资源都来自一个源，第一个平衡就是允许页面嵌入第三方资源

带来的挑战是页面被劫持注入第三方脚本，即 xss 攻击

浏览器的弥补策略是内容安全策略，即 CSP,其核心思想是让服务器决定浏览器能够加载哪些资源，让服务器决定浏览器是否能够执行内联 JavaScript 代码

##### 内容安全策略( CSP )

主要目标是减少和报告 XSS 攻击

你需要配置你的网络服务器返回 Content-Security-Policy HTTP 头部，除此之外, <meta> 元素也可以被用来配置该策略

#### 跨域资源共享和跨文档消息机制

不同站点无法进行跨站请求、无法操作 DOM，浏览器的平衡操作是提供跨域资源共享（CORS）、跨文档消息机制

##### 跨源资源共享（CORS）
