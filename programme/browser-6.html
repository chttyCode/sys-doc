<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>网络 | sys-doc</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/sys-doc/assets/css/0.styles.f2c13968.css" as="style"><link rel="preload" href="/sys-doc/assets/js/app.ff03e0ca.js" as="script"><link rel="preload" href="/sys-doc/assets/js/2.01d9652a.js" as="script"><link rel="preload" href="/sys-doc/assets/js/38.7779b874.js" as="script"><link rel="prefetch" href="/sys-doc/assets/js/10.331427a7.js"><link rel="prefetch" href="/sys-doc/assets/js/11.89b28dfb.js"><link rel="prefetch" href="/sys-doc/assets/js/12.ba3f9037.js"><link rel="prefetch" href="/sys-doc/assets/js/13.f8a5c702.js"><link rel="prefetch" href="/sys-doc/assets/js/14.b0c7cf4d.js"><link rel="prefetch" href="/sys-doc/assets/js/15.28671588.js"><link rel="prefetch" href="/sys-doc/assets/js/16.edc12257.js"><link rel="prefetch" href="/sys-doc/assets/js/17.13d64156.js"><link rel="prefetch" href="/sys-doc/assets/js/18.61d35156.js"><link rel="prefetch" href="/sys-doc/assets/js/19.05bd98c3.js"><link rel="prefetch" href="/sys-doc/assets/js/20.a0cf136a.js"><link rel="prefetch" href="/sys-doc/assets/js/21.03ded64d.js"><link rel="prefetch" href="/sys-doc/assets/js/22.48cb9c16.js"><link rel="prefetch" href="/sys-doc/assets/js/23.0c180cf1.js"><link rel="prefetch" href="/sys-doc/assets/js/24.77e09a3e.js"><link rel="prefetch" href="/sys-doc/assets/js/25.e55672d9.js"><link rel="prefetch" href="/sys-doc/assets/js/26.e11de8a1.js"><link rel="prefetch" href="/sys-doc/assets/js/27.e81e4d27.js"><link rel="prefetch" href="/sys-doc/assets/js/28.86516cc2.js"><link rel="prefetch" href="/sys-doc/assets/js/29.feeb398a.js"><link rel="prefetch" href="/sys-doc/assets/js/3.50da570f.js"><link rel="prefetch" href="/sys-doc/assets/js/30.18bddb07.js"><link rel="prefetch" href="/sys-doc/assets/js/31.c1c95649.js"><link rel="prefetch" href="/sys-doc/assets/js/32.e314141f.js"><link rel="prefetch" href="/sys-doc/assets/js/33.245c25a8.js"><link rel="prefetch" href="/sys-doc/assets/js/34.98ca6147.js"><link rel="prefetch" href="/sys-doc/assets/js/35.416394de.js"><link rel="prefetch" href="/sys-doc/assets/js/36.189ed700.js"><link rel="prefetch" href="/sys-doc/assets/js/37.ea3b68b8.js"><link rel="prefetch" href="/sys-doc/assets/js/39.6d8c0228.js"><link rel="prefetch" href="/sys-doc/assets/js/4.ba3164ba.js"><link rel="prefetch" href="/sys-doc/assets/js/40.833df0a0.js"><link rel="prefetch" href="/sys-doc/assets/js/41.e15859ac.js"><link rel="prefetch" href="/sys-doc/assets/js/42.50d4eaf7.js"><link rel="prefetch" href="/sys-doc/assets/js/43.8ac4c6d3.js"><link rel="prefetch" href="/sys-doc/assets/js/44.e6e0d7a1.js"><link rel="prefetch" href="/sys-doc/assets/js/45.a9a90201.js"><link rel="prefetch" href="/sys-doc/assets/js/46.a3cab201.js"><link rel="prefetch" href="/sys-doc/assets/js/47.c2690f0e.js"><link rel="prefetch" href="/sys-doc/assets/js/48.b68b2b19.js"><link rel="prefetch" href="/sys-doc/assets/js/49.cb96763b.js"><link rel="prefetch" href="/sys-doc/assets/js/5.75a3592b.js"><link rel="prefetch" href="/sys-doc/assets/js/50.68a84c7c.js"><link rel="prefetch" href="/sys-doc/assets/js/51.26054d26.js"><link rel="prefetch" href="/sys-doc/assets/js/52.8e98eb4d.js"><link rel="prefetch" href="/sys-doc/assets/js/53.354e7bd3.js"><link rel="prefetch" href="/sys-doc/assets/js/54.0f23ef6f.js"><link rel="prefetch" href="/sys-doc/assets/js/55.071e2888.js"><link rel="prefetch" href="/sys-doc/assets/js/56.dfb42cb8.js"><link rel="prefetch" href="/sys-doc/assets/js/57.4a5d4ac8.js"><link rel="prefetch" href="/sys-doc/assets/js/58.b00ec14b.js"><link rel="prefetch" href="/sys-doc/assets/js/59.958cf63d.js"><link rel="prefetch" href="/sys-doc/assets/js/6.0377ba0c.js"><link rel="prefetch" href="/sys-doc/assets/js/60.64ddd354.js"><link rel="prefetch" href="/sys-doc/assets/js/61.2007a023.js"><link rel="prefetch" href="/sys-doc/assets/js/62.41731cca.js"><link rel="prefetch" href="/sys-doc/assets/js/63.72df2c11.js"><link rel="prefetch" href="/sys-doc/assets/js/64.f7935f99.js"><link rel="prefetch" href="/sys-doc/assets/js/65.52bcf092.js"><link rel="prefetch" href="/sys-doc/assets/js/66.674b4f8d.js"><link rel="prefetch" href="/sys-doc/assets/js/67.a732865b.js"><link rel="prefetch" href="/sys-doc/assets/js/68.872a0efc.js"><link rel="prefetch" href="/sys-doc/assets/js/69.19aa3b32.js"><link rel="prefetch" href="/sys-doc/assets/js/7.dc078c9b.js"><link rel="prefetch" href="/sys-doc/assets/js/70.83ac44b2.js"><link rel="prefetch" href="/sys-doc/assets/js/71.503bbcf1.js"><link rel="prefetch" href="/sys-doc/assets/js/72.a64cf2db.js"><link rel="prefetch" href="/sys-doc/assets/js/73.3dd465e9.js"><link rel="prefetch" href="/sys-doc/assets/js/74.f0c960da.js"><link rel="prefetch" href="/sys-doc/assets/js/75.f1e4a186.js"><link rel="prefetch" href="/sys-doc/assets/js/76.2b2a6934.js"><link rel="prefetch" href="/sys-doc/assets/js/77.40b928a4.js"><link rel="prefetch" href="/sys-doc/assets/js/78.536b88ce.js"><link rel="prefetch" href="/sys-doc/assets/js/79.4b8fb840.js"><link rel="prefetch" href="/sys-doc/assets/js/8.ada5e17a.js"><link rel="prefetch" href="/sys-doc/assets/js/80.b02dec95.js"><link rel="prefetch" href="/sys-doc/assets/js/81.98911be8.js"><link rel="prefetch" href="/sys-doc/assets/js/82.b49b961d.js"><link rel="prefetch" href="/sys-doc/assets/js/83.1cec6ac3.js"><link rel="prefetch" href="/sys-doc/assets/js/9.fde67e0a.js">
    <link rel="stylesheet" href="/sys-doc/assets/css/0.styles.f2c13968.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/sys-doc/" class="home-link router-link-active"><img src="/sys-doc/imgs/logo.jpeg" alt="sys-doc" class="logo"> <span class="site-name can-hide">sys-doc</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/sys-doc/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/sys-doc/programme/" class="nav-link router-link-active">
  编程
</a></div><div class="nav-item"><a href="/sys-doc/engineer/" class="nav-link">
  工程
</a></div><div class="nav-item"><a href="/sys-doc/framework/" class="nav-link">
  架构
</a></div><div class="nav-item"><a href="/sys-doc/shell/" class="nav-link">
  集锦
</a></div><div class="nav-item"><a href="/sys-doc/leetCode/" class="nav-link">
  LCode
</a></div> <a href="https://github.com/chttyCode/sys-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/sys-doc/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/sys-doc/programme/" class="nav-link router-link-active">
  编程
</a></div><div class="nav-item"><a href="/sys-doc/engineer/" class="nav-link">
  工程
</a></div><div class="nav-item"><a href="/sys-doc/framework/" class="nav-link">
  架构
</a></div><div class="nav-item"><a href="/sys-doc/shell/" class="nav-link">
  集锦
</a></div><div class="nav-item"><a href="/sys-doc/leetCode/" class="nav-link">
  LCode
</a></div> <a href="https://github.com/chttyCode/sys-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/sys-doc/programme/" aria-current="page" class="sidebar-link">编程</a></li><li><a href="/sys-doc/programme/git.html" class="sidebar-link">git</a></li><li><a href="/sys-doc/programme/vscode.html" class="sidebar-link">vscode</a></li><li><a href="/sys-doc/programme/typescript.html" class="sidebar-link">Typescript</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/sys-doc/programme/mini-program.html" class="sidebar-link">小程序</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>nodejs</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>浏览器</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sys-doc/programme/browser.html" class="sidebar-link">Browser</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>工作原理&amp;实践</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sys-doc/programme/browser-1.html" class="sidebar-link">宏观视角下的浏览器</a></li><li><a href="/sys-doc/programme/browser-2.html" class="sidebar-link">Js 的执行机制</a></li><li><a href="/sys-doc/programme/browser-3.html" class="sidebar-link">V8 工作原理</a></li><li><a href="/sys-doc/programme/browser-4.html" class="sidebar-link">循环系统</a></li><li><a href="/sys-doc/programme/browser-5.html" class="sidebar-link">页面</a></li><li><a href="/sys-doc/programme/browser-6.html" aria-current="page" class="active sidebar-link">网络</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sys-doc/programme/browser-6.html#http-1" class="sidebar-link">http/1</a></li><li class="sidebar-sub-header"><a href="/sys-doc/programme/browser-6.html#http-2" class="sidebar-link">http/2</a></li><li class="sidebar-sub-header"><a href="/sys-doc/programme/browser-6.html#http3-0" class="sidebar-link">http3.0</a></li></ul></li><li><a href="/sys-doc/programme/browser-7.html" class="sidebar-link">安全</a></li><li><a href="/sys-doc/programme/browser-8.html" class="sidebar-link">share browser</a></li><li><a href="/sys-doc/programme/browser-9.html" class="sidebar-link">专题</a></li></ul></section></li><li><a href="/sys-doc/programme/v8.html" class="sidebar-link">Google V8</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="网络"><a href="#网络" class="header-anchor">#</a> 网络</h1> <h2 id="http-1"><a href="#http-1" class="header-anchor">#</a> http/1</h2> <p>说到浏览器中的网络，最重要的莫过于 http 了,而要学习 http 做好的方式是探究其演进的过程</p> <h3 id="http-0-9"><a href="#http-0-9" class="header-anchor">#</a> http/0.9</h3> <p>http 协议又称超文本传输协议，0.9 也正式用来传输纯文本信息</p> <p>因为只要解决文本信息的传输，所以客户端和服务器的需求都很明确，只要告诉对方需要文本信息的 name 即可</p> <p>过程很简单：</p> <ol><li>建立 tcp 链接</li> <li>发送 get 请求资源</li> <li>文档传输完成、断开链接</li></ol> <p>此刻的 http:</p> <ol><li>只有一个请求行</li> <li>服务器只需返回文本信息</li> <li>返回内容以 ASCII 字符流来传输的</li></ol> <h3 id="http-1-0"><a href="#http-1-0" class="header-anchor">#</a> http/1.0</h3> <p>由于浏览器的推出，传输内容变得复杂，传输内容、编码也不再是到单一 ASCII 所能解决的，那浏览器与服务器就不再是你要我给，而是要进行一番协商了</p> <p>协商的方式就是新增请求头、响应头，以 key-value 形式保存内容</p> <p>请求头、响应头解决了那些问题</p> <ol><li>返回文件类型、编码方式，浏览器需要通过类型提供处理方案</li> <li>文件内容压缩方式，毕竟传输内容不再局限于文本信息</li> <li>新增状态码，告知浏览器该请求是否可以被解析</li> <li>提供 cache 机制，告诉浏览器是否要重新发起请求</li> <li>提供用户代理字段，便于服务器统计</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>accept<span class="token operator">:</span> text<span class="token operator">/</span>html
accept<span class="token operator">-</span>encoding<span class="token operator">:</span> gzip<span class="token punctuation">,</span> deflate<span class="token punctuation">,</span> br
accept<span class="token operator">-</span>Charset<span class="token operator">:</span> <span class="token constant">ISO</span><span class="token operator">-</span><span class="token number">8859</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>utf<span class="token operator">-</span><span class="token number">8</span>
accept<span class="token operator">-</span>language<span class="token operator">:</span> zh<span class="token operator">-</span><span class="token constant">CN</span><span class="token punctuation">,</span>zh
</code></pre></div><p>告诉发展下 1.0 存在的问题</p> <ol><li>每个请求都要建立 tcp 链接，费时费流量</li></ol> <h3 id="http1-1"><a href="#http1-1" class="header-anchor">#</a> http1.1</h3> <p>主要是解决 1.0 发展遇到的问题</p> <ol><li>提供持久链接，提供请求头告知浏览器 Connection：keep-alive</li> <li>提供 host 应对虚拟主机问题，即多个域名对应一个 ip</li> <li>浏览器为每个域名最多同时维护 6 个 TCP 持久连接</li> <li>使用 CDN 的实现域名分片机制</li></ol> <h2 id="http-2"><a href="#http-2" class="header-anchor">#</a> http/2</h2> <p>主要解决 1.1 高速发展带来的问题：</p> <ol><li>支持持久化带来的的对头阻塞</li> <li>带宽利用率低，带宽是指每秒最大能发送或者接收的字节数。我们把每秒能发送的最大字节数称为上行带宽，每秒能够接收的最大字节数称为下行带宽</li></ol> <p>分析：</p> <p>HTTP/1.1 对带宽的利用率不理想，是因为 HTTP/1.1 很难将带宽用满。比如我们常说的 100M 带宽，实际的下载速度能达到 12.5M/S，而采用 HTTP/1.1 时，也许在加载页面资源时最大只能使用到 2.5M/S，很难将 12.5M 全部用满</p> <ol><li>tcp 的慢启动，刚开始 TCP 协议会采用一个非常慢的速度去发送数据，然后慢慢加快发送数据的速度，直到发送数据的速度达到一个理想状态，我们把这个过程称为慢启动。慢启动是 TCP 为了减少网络拥塞的一种策略，我们是没有办法改变的。</li> <li>对同一个域名可同时建立 6 个 tcp 链接，多条链接的会竞争一定的带宽</li> <li>队头阻塞，tcp 的持久化，虽然可以减少建立 tcp 的连接数和时间，但是持久化是串行</li></ol> <p>即慢启动和 TCP 连接之间相互竞争带宽是由于 TCP 本身的机制导致的，而队头阻塞是由于 HTTP/1.1 的机制导致的。由于 tcp 更新涉及硬件，所以暂时没能力去更换 tcp</p> <p>解决方案：</p> <ol><li>一个域名只建立一个长链接，解决多链接竞速带宽问题</li> <li>在一个链接中采用并行请求的方式，多路复用，解决对头阻塞问题</li></ol> <p>多路复用：</p> <p><img src="/sys-doc/imgs/http2.0.png" alt="alt http2.0"></p> <p>http2.0 新增了一个分桢层，主要就是对通信数据添加 ID 编号，这样在多路复用的情况下就可以采用 ID 编号进行消息的合并</p> <p>在多路复用的基础之上</p> <ol><li>可以对资源设置优先级</li> <li>服务器推送，预判推送与请求相关的资源</li> <li>提供了头部的压缩，即可以对请求响应头进行压缩</li></ol> <h2 id="http3-0"><a href="#http3-0" class="header-anchor">#</a> http3.0</h2> <p>主要解决 http2.0 的遗留问题</p> <ol><li>tcp 队头阻塞，主要原因是 http1.0/http2.0 都是基于 tcp 做的，而 tcp 又是为单链接而设计的，并提供了重传机制，即有一个包丢失，就会阻塞其他请求</li> <li>链接延时，因为 tcp 有三次握手的机制，要消耗 1.5RTT，再加上协商建立 TLS 需要 1 ～ 2RTT，即建立链接就需要 3 ～ 4 个 RTT，如果 1 个 RTT 就可能需要 100 毫秒以上了，这种情况下整个握手过程需要 300 ～ 400 毫秒</li> <li>tcp 协议僵化,即中间网络互联设备的僵化，操作系统也是导致 TCP 协议僵化的另外一个原因。因为 TCP 协议都是通过操作系统内核来实现的</li></ol> <p>解决方案：</p> <p>此刻可以发现已经探究到了底层的 tcp 协议了，而且不易改变。因此 http3.0 另辟蹊径，基于 UDP 实现了类似于 TCP 的多路数据流、传输可靠性等功能,又称 QUIC 协议。</p> <p><img src="/sys-doc/imgs/http3.0.png" alt="alt http3.0"></p> <p>QUIC 功能</p> <ol><li>实现 tcp 的重传机制</li> <li>建立 TLS 链接</li> <li>基于 udp 可以传输多个独立数据流的特性实现了 HTTP/2 中的多路复用功能。解决了 TCP 中队头阻塞的问题。</li></ol> <p><img src="/sys-doc/imgs/quic.png" alt="alt http3.0"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/chttyCode/sys-doc/edit/master/docs/programme/browser-6.md" target="_blank" rel="noopener noreferrer">编辑此内容</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/05/26</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/sys-doc/programme/browser-5.html" class="prev">
        页面
      </a></span> <span class="next"><a href="/sys-doc/programme/browser-7.html">
        安全
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/sys-doc/assets/js/app.ff03e0ca.js" defer></script><script src="/sys-doc/assets/js/2.01d9652a.js" defer></script><script src="/sys-doc/assets/js/38.7779b874.js" defer></script>
  </body>
</html>
